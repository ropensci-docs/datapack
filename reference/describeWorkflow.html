<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Add information about the relationships among DataObject members 
in a DataPackage, retrospectively describing the way in which derived data were 
created from source data using a processing program such as an R script.  These provenance
relationships allow the derived data to be understood sufficiently for users
to be able to reproduce the computations that created the derived data, and to
trace lineage of the derived data objects. The method describeWorkflow 
will add provenance relationships between a script that was executed, the files 
that it used as sources, and the derived files that it generated."><title>Add data derivation information to a DataPackage — describeWorkflow • datapack</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add data derivation information to a DataPackage — describeWorkflow"><meta property="og:description" content="Add information about the relationships among DataObject members 
in a DataPackage, retrospectively describing the way in which derived data were 
created from source data using a processing program such as an R script.  These provenance
relationships allow the derived data to be understood sufficiently for users
to be able to reproduce the computations that created the derived data, and to
trace lineage of the derived data objects. The method describeWorkflow 
will add provenance relationships between a script that was executed, the files 
that it used as sources, and the derived files that it generated."><meta property="og:image" content="https://docs.ropensci.org/datapack/logo.png"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">datapack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/datapack-overview.html">datapack R Package Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/datapack/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add data derivation information to a DataPackage</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/datapack/blob/HEAD/R/DataPackage.R" class="external-link"><code>R/DataPackage.R</code></a></small>
      <div class="d-none name"><code>describeWorkflow.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add information about the relationships among DataObject members 
in a DataPackage, retrospectively describing the way in which derived data were 
created from source data using a processing program such as an R script.  These provenance
relationships allow the derived data to be understood sufficiently for users
to be able to reproduce the computations that created the derived data, and to
trace lineage of the derived data objects. The method <code>describeWorkflow</code> 
will add provenance relationships between a script that was executed, the files 
that it used as sources, and the derived files that it generated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">describeWorkflow</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DataPackage</span></span>
<span><span class="fu">describeWorkflow</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  program <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  derivations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  insertDerivations <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>The <code>DataPackage</code> to add provenance relationships to.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters</p></dd>


<dt>sources</dt>
<dd><p>A list of DataObjects for files that were read by the program. Alternatively, a list 
of DataObject identifiers can be specified as a list of character strings.</p></dd>


<dt>program</dt>
<dd><p>The DataObject created for the program such as an R script. Alternatively the DataObject identifier can
be specified.</p></dd>


<dt>derivations</dt>
<dd><p>A list of DataObjects for files that were generated by the program. Alternatively, a list 
of DataObject identifiers can be specified as a list of character strings.</p></dd>


<dt>insertDerivations</dt>
<dd><p>A <code>logical</code> value. If TRUE then the provenance relationship 
<code>prov:wasDerivedFrom</code> will be used to connect every source and derivation. The default value 
is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This method operates on a DataPackage that has had DataObjects for 
the script, data sources (inputs), and data derivations (outputs) previously 
added to it, or can reference identifiers for objects that exist in other DataPackage
instances. This allows a user to create a standalone package that contains all of
its source, script, and derived data, or a set of data packages that are chained
together via a set of derivation relationships between the members of those packages.</p>
<p>Provenance relationships are described following the the ProvONE data model, which
can be viewed at <a href="https://purl.dataone.org/provone-v1-dev" class="external-link">https://purl.dataone.org/provone-v1-dev</a>.  In particular, 
the following relationships are inserted (among others):</p><ul><li><p><code>prov:used</code> indicates which source data was used by a program execution</p></li>
<li><p><code>prov:generatedBy</code> indicates which derived data was created by a program execution</p></li>
<li><p><code>prov:wasDerivedFrom</code> indicates the source data from which derived data were created using the program</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The R 'recordr' package for run-time recording of provenance relationships.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/datapack/">datapack</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"DataPackage"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Add the script to the DataPackage</span></span></span>
<span class="r-in"><span><span class="va">progFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/pkg-example/logit-regression-example.R"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">progObj</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"DataObject"</span>, format<span class="op">=</span><span class="st">"application/R"</span>, filename<span class="op">=</span><span class="va">progFile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">progObj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a script input to the DataPackage</span></span></span>
<span class="r-in"><span><span class="va">inFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/pkg-example/binary.csv"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">inObj</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"DataObject"</span>, format<span class="op">=</span><span class="st">"text/csv"</span>, filename<span class="op">=</span><span class="va">inFile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">inObj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a script output to the DataPackage</span></span></span>
<span class="r-in"><span><span class="va">outFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/pkg-example/gre-predicted.png"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outObj</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"DataObject"</span>, format<span class="op">=</span><span class="st">"image/png"</span>, file<span class="op">=</span><span class="va">outFile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">outObj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add the provenenace relationshps, linking the input and output to the script execution</span></span></span>
<span class="r-in"><span><span class="co"># Note: 'sources' and 'derivations' can also be lists of "DataObjects" or "DataObject' identifiers</span></span></span>
<span class="r-in"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu">describeWorkflow</span><span class="op">(</span><span class="va">dp</span>, sources <span class="op">=</span> <span class="va">inObj</span>, program <span class="op">=</span> <span class="va">progObj</span>, derivations <span class="op">=</span> <span class="va">outObj</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co"># View the results</span></span></span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="getRelationships.html">getRelationships</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                          subject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          _10ebd4dc-a4e2-4bfa-9b03-5606612624a4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          _10ebd4dc-a4e2-4bfa-9b03-5606612624a4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  urn:uuid:1d296755-15b0-49db-9a67-13f1c7b3a7bd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  urn:uuid:5e8600fe-9933-4aa8-baa0-d547b41ad581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  urn:uuid:66284e63-c365-4605-856f-e7d5ebd5699a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 urn:uuid:66284e63-c365-4605-856f-e7d5ebd5699a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                          predicate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  http://www.w3.org/1999/02/22-rdf-syntax-ns#type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                http://www.w3.org/ns/prov#hadPlan</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  http://www.w3.org/1999/02/22-rdf-syntax-ns#type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  http://www.w3.org/1999/02/22-rdf-syntax-ns#type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  http://www.w3.org/1999/02/22-rdf-syntax-ns#type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11        http://www.w3.org/ns/prov#wasDerivedFrom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         object subjectType</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                        http://www.w3.org/ns/prov#Association       blank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                urn:uuid:1d296755-15b0-49db-9a67-13f1c7b3a7bd       blank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  http://purl.dataone.org/provone/2015/01/15/ontology#Program        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     http://purl.dataone.org/provone/2015/01/15/ontology#Data        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     http://purl.dataone.org/provone/2015/01/15/ontology#Data        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11               urn:uuid:5e8600fe-9933-4aa8-baa0-d547b41ad581        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    objectType dataTypeURI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         uri        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         uri        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7         uri        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         uri        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         uri        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       &lt;NA&gt;        &lt;NA&gt;</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

