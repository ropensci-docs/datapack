<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="datapack">
<title>datapack R Package Overview • datapack</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="datapack R Package Overview">
<meta property="og:description" content="datapack">
<meta property="og:image" content="https://docs.ropensci.org/datapack/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">datapack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/datapack-overview.html">datapack R Package Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/datapack/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>datapack R Package Overview</h1>
            
            <h4 data-toc-skip class="date">2024-03-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/datapack/blob/HEAD/vignettes/datapack-overview.Rmd" class="external-link"><code>vignettes/datapack-overview.Rmd</code></a></small>
      <div class="d-none name"><code>datapack-overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <em>datapack</em> R package provides an abstraction for collating multiple data objects of different types and metadata describing those objects into a bundle that can be transported and loaded using a single composite file. It is primarily meant as a container to bundle together files for transport to or from DataONE data repositories.</p>
<p>The methods in this package provide a convenient way to load data from common repositories such as DataONE into the R environment, and to document, serialize, and save data from R to data repositories.</p>
</div>
<div class="section level2">
<h2 id="create-a-single-object">Create a Single Object<a class="anchor" aria-label="anchor" href="#create-a-single-object"></a>
</h2>
<p>The <em>datapack</em> DataObject class is a wrapper that contains both data and system metadata that describes the data. The data can be either R <code>raw</code> data or a data file, for example a CSV file. The system metadata includes attributes such as the object identifier, type, size, checksum, owner, version relationship to other objects, access rules, and other critical metadata. The DataObject class also holds additional metadata about the data file. For example, where the file should go when the package is downloaded. This is often times the same as the filepath however, care should be taken to not include any drive letters or unnecessary folders.</p>
<p>The following example shows how to create a DataObject locally from a CSV file:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/datapack/">datapack</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rforge.net/uuid" class="external-link">uuid</a></span><span class="op">)</span></span>
<span><span class="va">csvfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/sample-data.csv"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span>
<span><span class="va">myId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"urn:uuid:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">myObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, id<span class="op">=</span><span class="va">myId</span>, format<span class="op">=</span><span class="st">"text/csv"</span>, filename<span class="op">=</span><span class="va">csvfile</span>, targetPath<span class="op">=</span><span class="st">"extdata/sample-data.csv"</span><span class="op">)</span></span></code></pre></div>
<p>The DataObject <code>myObj</code> now contains the CSV data as well as the system-level information describing the file, such as its identifier, type, and checksum. The <em>getData</em> method can be used to extract the data content of a DataObject. Using the example DataObject:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rawData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="va">myObj</span><span class="op">)</span></span></code></pre></div>
<p>This raw data can be converted back to CSV format using the R commands:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext<span class="op">=</span><span class="st">".csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">rawToChar</a></span><span class="op">(</span><span class="va">rawData</span><span class="op">)</span>, <span class="va">tf</span>, quote<span class="op">=</span><span class="cn">F</span>, row.names<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, the CSV data could be converted into a data frame using standard R functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/textconnections.html" class="external-link">textConnection</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">rawToChar</a></span><span class="op">(</span><span class="va">rawData</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             Species_Name light temp cont moist react nutr</span></span>
<span><span class="co">## 1  Achillea millefolium      8    0    0     4     0    5</span></span>
<span><span class="co">## 2 Achillea tanacetifolia     0    0    0     0     0    0</span></span>
<span><span class="co">## 3    Aconitum lycoctonum     3    4    4     7     7    8</span></span>
<span><span class="co">## 4    Aconitum variegatum     5    4    4     7     8    7</span></span>
<span><span class="co">## 5         Actaea spicata     3    5    4     5     6    7</span></span>
<span><span class="co">## 6  Aegopodium podagraria     5    5    3     6     7    8</span></span></code></pre>
<p>If the data were another format than CSV, such as PNG, JPEG, or NetCDF, the corresponding R packages could be used to handle the object.</p>
<p>Each DataObject has an identifier which can be used to refer to that object, and is meant to be globally unique so that it can be used in data repositories such as those from the DataONE federation. To retrieve the identifier associated with a DataObject:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getIdentifier.html">getIdentifier</a></span><span class="op">(</span><span class="va">myObj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "urn:uuid:b7788262-177a-4ddf-89c2-1198a245c6e4"</span></span></code></pre>
<p>In this case, the identifier was created in the UUID format, but other identifiers such as DOIs (Digital Object Identifers) can also be used. Each object also is associated with a specific format. To retrieve the format type:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getFormatId.html">getFormatId</a></span><span class="op">(</span><span class="va">myObj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "text/csv"</span></span></code></pre>
<div class="section level3">
<h3 id="system-metadata">System Metadata<a class="anchor" aria-label="anchor" href="#system-metadata"></a>
</h3>
<p>All system metadata information for a DataObject can be accessed directly from the SystemMetadata object contained in the DataObject. To access the <code>fileName</code> field, for example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myObj</span><span class="op">@</span><span class="va">sysmeta</span><span class="op">@</span><span class="va">fileName</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sample-data.csv"</span></span></code></pre>
<p>The system metadata contains access policy information for the DataObject that could be used by a data repository that the object is uploaded to. For example, when a DataObject is uploaded to a <a href="https://www.dataone.org/current-member-nodes" class="external-link">DataONE Member Node</a>, the access policy is applied to the uploaded data and controls access to the data on the Member Node by DataONE users.</p>
<div class="section level4">
<h4 id="access-policy">Access Policy<a class="anchor" aria-label="anchor" href="#access-policy"></a>
</h4>
<p>Before the DataObject is uploaded, access can be set so that anyone can read the uploaded data:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPublicAccess.html">setPublicAccess</a></span><span class="op">(</span><span class="va">myObj</span><span class="op">)</span></span>
<span><span class="va">myObj</span><span class="op">@</span><span class="va">sysmeta</span><span class="op">@</span><span class="va">accessPolicy</span></span></code></pre></div>
<pre><code><span><span class="co">##   subject permission</span></span>
<span><span class="co">## 1  public       read</span></span></code></pre>
<p>Individual access rules can also be added one at a time. The access rules are expressed using the unique identifier for an individual, such as their ORCID identity, or whatever form the repository supports.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addAccessRule.html">addAccessRule</a></span><span class="op">(</span><span class="va">myObj</span>, <span class="st">"https://orcid.org/0000-0003-0077-4738"</span>, <span class="st">"write"</span><span class="op">)</span></span>
<span><span class="va">myObj</span><span class="op">@</span><span class="va">sysmeta</span><span class="op">@</span><span class="va">accessPolicy</span></span></code></pre></div>
<pre><code><span><span class="co">##                                 subject permission</span></span>
<span><span class="co">## 1                                public       read</span></span>
<span><span class="co">## 2 https://orcid.org/0000-0003-0077-4738      write</span></span></code></pre>
<p>The permissions that can be set include:</p>
<ul>
<li>read: permission to read the data from the repository</li>
<li>write: permission to perform update operations on the data</li>
<li>changePermission: permission to control access to the data on the repository</li>
</ul>
<p>Alternatively, multiple access rules can be added:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accessRules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>subject<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uid=jsmith,o=Account,dc=example,dc=com"</span>,  </span>
<span>                                    <span class="st">"uid=jadams,o=Account,dc=example,dc=org"</span><span class="op">)</span>, </span>
<span>                          permission<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"write"</span>, <span class="st">"changePermission"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">myObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addAccessRule.html">addAccessRule</a></span><span class="op">(</span><span class="va">myObj</span>, <span class="va">accessRules</span><span class="op">)</span></span>
<span><span class="va">myObj</span><span class="op">@</span><span class="va">sysmeta</span><span class="op">@</span><span class="va">accessPolicy</span></span></code></pre></div>
<pre><code><span><span class="co">##                                  subject       permission</span></span>
<span><span class="co">## 1                                 public             read</span></span>
<span><span class="co">## 2  https://orcid.org/0000-0003-0077-4738            write</span></span>
<span><span class="co">## 3 uid=jsmith,o=Account,dc=example,dc=com            write</span></span>
<span><span class="co">## 4 uid=jadams,o=Account,dc=example,dc=org changePermission</span></span></code></pre>
<p>The <em>dataone</em> R package can be used to upload or download DataObjects to a DataONE Member Node. Please see the web page for the <a href="https://github.com/DataONEorg/rdataone" class="external-link"><em>dataone</em></a> R package and the vignettes for more information:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DataONEorg/rdataone" class="external-link">dataone</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"download-data"</span>, package<span class="op">=</span><span class="st">"dataone"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"upload-data"</span>, package<span class="op">=</span><span class="st">"dataone"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="create-a-collection-of-objects">Create a Collection of Objects<a class="anchor" aria-label="anchor" href="#create-a-collection-of-objects"></a>
</h2>
<p>A DataPackage is a container for a set of DataObjects. DataObject is a class that is a proxy for data of any type, including traditional data like CSV, tabular data, and spatial rasters, but also for non-traditional objects like derived data, figures, and scripts in R and Python. A collection of related DataObjects can be placed in a DataPackage and actions can be performed on it, such as serializing the entire collection of objects into a package file, or uploading all package member objects to a data repository.</p>
<p>Figure 1. is a diagram of a typical DataPackage showing a metadata file that describes, or <code>documents</code> the data granules that the package contains.</p>
<p><img src="package-diagram.png"></p>
<p>This example creates a DataPackage with one DataObject containing metadata and two others containing science data. First the individual objects are created:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadataFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/sample-eml.xml"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span>
<span><span class="va">metadataId</span> <span class="op">&lt;-</span> <span class="st">"metadataId"</span></span>
<span><span class="va">metadataObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, id<span class="op">=</span><span class="va">metadataId</span>, format<span class="op">=</span><span class="st">"eml://ecoinformatics.org/eml-2.1.0"</span>, file<span class="op">=</span><span class="va">metadataFile</span><span class="op">)</span></span>
<span></span>
<span><span class="va">csvfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/sample-data.csv"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span>
<span><span class="va">sciId</span> <span class="op">&lt;-</span> <span class="st">"sciId1"</span></span>
<span><span class="va">sciObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, id<span class="op">=</span><span class="va">sciId</span>, format<span class="op">=</span><span class="st">"text/csv"</span>, filename<span class="op">=</span><span class="va">csvfile</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/sample-data-filtered.csv"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span>
<span><span class="va">sciId2</span> <span class="op">&lt;-</span> <span class="st">"sciId2"</span></span>
<span><span class="va">sciObj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, id<span class="op">=</span><span class="va">sciId2</span>, filename<span class="op">=</span><span class="va">outFile</span>, format<span class="op">=</span><span class="st">"text/csv"</span><span class="op">)</span></span></code></pre></div>
<p>The identifier values used in this example are simple and easily recognizable for demonstration purposes. A more standard unique identifier can be created with the <code><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">uuid::UUIDgenerate()</a></code> function:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"urn:uuid:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">myid</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "urn:uuid:829d8ced-a1fd-4741-a5fe-a4f6ece109e2"</span></span></code></pre>
<p>Next a DataPackage is created and the DataObjects are added to it. Note the <code>mo</code> argument in the <code>addMember</code> function when adding the data file. Including this argument specifies that the metadata object documents the data object. More information on relationships between DataObjects is included in the next section.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataPackage"</span><span class="op">)</span></span>
<span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, do <span class="op">=</span> <span class="va">metadataObj</span><span class="op">)</span></span>
<span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, do <span class="op">=</span> <span class="va">sciObj</span>, mo <span class="op">=</span> <span class="va">metadataObj</span><span class="op">)</span></span>
<span><span class="co"># The second object will be added in the next section </span></span></code></pre></div>
<p>Information can also be extracted from the DataPackage. To show the identifiers of the DataObjects that are in the package:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getIdentifiers.html">getIdentifiers</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "metadataId" "sciId1"</span></span></code></pre>
<p>To show the number of DataObjects in the package:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getSize.html">getSize</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<p>To extract the data in a DataObject as raw data, ask for the data using the identifier of the DataObject:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sciObjRaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">sciId</span><span class="op">)</span></span></code></pre></div>
<p>To get access to the full instance of the DataObject class representing a data object, use the <code><a href="../reference/getMember.html">datapack::getMember</a></code> function and pass in the identifier of the desired object, which will return an instance of the DataObject class:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySciObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getMember.html">getMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">sciId</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="relationships-between-dataobjects">Relationships Between DataObjects<a class="anchor" aria-label="anchor" href="#relationships-between-dataobjects"></a>
</h2>
<p>The relationships between DataObjects in a DataPackage can be recorded in the DataPackage. For example, a typical relationship is that a DataObject containing a metadata document in a domain specific format such as Ecological Metadata Language (EML) or ISO19139 geospatial metadata can describe, or document, DataObjects containing associated science data. Adding relationship information about data package members may assist a consumer of the package in better understanding the contents of the package and how to make use of the package.</p>
<p>While the DataPackage can record any type of relationships that are important to a community, we have provided functions to establish common relationships that are needed to understand scientific data in the DataONE federation. These include the following typical provenance properties:</p>
<ul>
<li>
<code>cito:documents</code>: for establishing that a metadata document provides descriptive information about one or more associated data objects</li>
<li>
<code>prov:wasDerivedFrom</code>: for asserting that a derived data object was created using data from one or more source data objects</li>
<li>
<code>prov:used</code>: for asserting that when a program (such as an R script) was executed that it used one or more source data objects as inputs</li>
<li>
<code>prov:wasGeneratedBy</code>: for asserting that when a program (such as an R script) was executed that it generated one or more derived data objects as outputs</li>
</ul>
<p>Figure 2. A DataPackage with provenance relationships.</p>
<p><img src="package-diagram-with-prov.png"></p>
<div class="section level3">
<h3 id="linking-a-metadata-file-with-one-or-more-data-files-using-citodocuments">Linking a metadata file with one or more data files using cito:documents<a class="anchor" aria-label="anchor" href="#linking-a-metadata-file-with-one-or-more-data-files-using-citodocuments"></a>
</h3>
<p>As mentioned above, the fastest way to add the <code>cito:documents</code> relationship is to include the metadata object when a science data object is added to the package:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, do <span class="op">=</span> <span class="va">sciObj2</span>, mo <span class="op">=</span> <span class="va">metadataObj</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getRelationships.html">getRelationships</a></span><span class="op">(</span><span class="va">dp</span>, condense<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   subject           predicate                  object</span></span>
<span><span class="co">## 4 sample-dat...ltered.csv cito:isDocumentedBy          sample-eml.xml</span></span>
<span><span class="co">## 2         sample-data.csv cito:isDocumentedBy          sample-eml.xml</span></span>
<span><span class="co">## 1          sample-eml.xml      cito:documents         sample-data.csv</span></span>
<span><span class="co">## 3          sample-eml.xml      cito:documents sample-dat...ltered.csv</span></span></code></pre>
<p>In that example, the <code>sciObj2</code> DataObject is added to the package using the <code>addMember</code> call, and the metadata object <code>metadataObj</code> is passed in to the function as well. This tells the DataPackage that <code>metadataId cito:documents sciId2</code>. The <code>cito:documents</code> relationship is defined by the <a href="https://sparontologies.github.io/cito/current/cito.html" class="external-link">Citation Typing Ontology</a> (CITO)).</p>
</div>
</div>
<div class="section level2">
<h2 id="asserting-data-provenance-relationships-between-objects">Asserting data provenance relationships between objects<a class="anchor" aria-label="anchor" href="#asserting-data-provenance-relationships-between-objects"></a>
</h2>
<p>Relationships that describe the processing history of package members can be added. For example, a program that performs a modeling calculation might read one or more source data files as inputs, perform a calculation based on the data read, and then write a data or graphics file characterizing the results of the model run.</p>
<p>The <code>datapack</code> package uses the <a href="https://purl.dataone.org/provone-v1-dev" class="external-link">ProvONE</a> data model to represent provenance relationships.</p>
<p>The following example demonstrates how to insert provenance relationships into a DataPackage for the R program <code>logit-regression.R</code> that reads the source data file <code>binary.csv</code> and generates the derived image file <code>gre-predicted.png</code>. Using the example DataPackage for which DataObjects for the program input and output have already been added, we create a DataObject for the program, and call <code>describeWorkflow</code> to add the necessary provenance relationships:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataPackage"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metadataFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/sample-eml.xml"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span></span>
<span><span class="va">metadataId</span> <span class="op">&lt;-</span> <span class="st">"metadataId"</span></span>
<span><span class="va">metadataObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, id<span class="op">=</span><span class="va">metadataId</span>, format<span class="op">=</span><span class="st">"eml://ecoinformatics.org/eml-2.1.0"</span>, file<span class="op">=</span><span class="va">metadataFile</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This DataObject contains the program script that was executed</span></span>
<span><span class="va">progObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, format<span class="op">=</span><span class="st">"application/R"</span>, </span>
<span>           filename<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/pkg-example/logit-regression-example.R"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">progObj</span>, mo <span class="op">=</span> <span class="va">metadataObj</span><span class="op">)</span></span>
<span></span>
<span><span class="va">doIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, format<span class="op">=</span><span class="st">"text/csv"</span>, </span>
<span>             filename<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/pkg-example/binary.csv"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">doIn</span>, mo <span class="op">=</span> <span class="va">metadataObj</span><span class="op">)</span></span>
<span></span>
<span><span class="va">doOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"DataObject"</span>, format<span class="op">=</span><span class="st">"image/png"</span>, </span>
<span>             filename<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/pkg-example/gre-predicted.png"</span>, package<span class="op">=</span><span class="st">"datapack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addMember.html">addMember</a></span><span class="op">(</span><span class="va">dp</span>, <span class="va">doOut</span>, mo <span class="op">=</span> <span class="va">metadataObj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The arguments "sources" and "derivations" can also contain lists of "DataObjects"</span></span>
<span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/describeWorkflow.html">describeWorkflow</a></span><span class="op">(</span><span class="va">dp</span>, sources<span class="op">=</span><span class="va">doIn</span>, program<span class="op">=</span><span class="va">progObj</span>, derivations<span class="op">=</span><span class="va">doOut</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">rels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getRelationships.html">getRelationships</a></span><span class="op">(</span><span class="va">dp</span>, condense<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rels</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"prov:"</span>, <span class="va">rels</span><span class="op">$</span><span class="va">predicate</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                    subject               predicate                  object</span></span>
<span><span class="co">## 11 _1eb3c1e5-...7cf531e289            prov:hadPlan logit-regr...-example.R</span></span>
<span><span class="co">## 17       gre-predicted.png     prov:wasDerivedFrom              binary.csv</span></span>
<span><span class="co">## 16       gre-predicted.png     prov:wasGeneratedBy urn:uuid:3...b1bc57b355</span></span>
<span><span class="co">## 9  urn:uuid:3...b1bc57b355 prov:quali...ssociation _1eb3c1e5-...7cf531e289</span></span>
<span><span class="co">## 15 urn:uuid:3...b1bc57b355               prov:used              binary.csv</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotRelationships.html">plotRelationships</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span></span></code></pre></div>
<p><img src="datapack-overview_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<p>Note that in this example, the R script had previously been run and generated the image file before <code><a href="../reference/describeWorkflow.html">describeWorkflow()</a></code> was called. The <code>sources</code> and <code>derivations</code> arguments for <code><a href="../reference/describeWorkflow.html">describeWorkflow()</a></code> can be lists of either DataObjects or the identifiers of DataObjects.</p>
<div class="section level3">
<h3 id="inserting-other-arbitrary-relationships">Inserting other (arbitrary) relationships<a class="anchor" aria-label="anchor" href="#inserting-other-arbitrary-relationships"></a>
</h3>
<p>Other types of relationships between DataPackage member DataObjects can be recorded with the <code>insertRelationship</code> method. The main requirement is that each relationship to be described needs to have a unique URI that is drawn from a controlled vocabulary like the Citation Typing Ontology described above. The <code>cito:documents</code> relationship is the default used by <code>insertRelationship</code>, so the relationship type doesn’t need to be specified in this case. For example, with the example DataPackage created above, we can add the <code>cito:documents</code> relationship:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/insertRelationship.html">insertRelationship</a></span><span class="op">(</span><span class="va">dp</span>, subjectID<span class="op">=</span><span class="va">metadataId</span>, objectIDs<span class="op">=</span><span class="va">sciId</span><span class="op">)</span></span>
<span><span class="va">relations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getRelationships.html">getRelationships</a></span><span class="op">(</span><span class="va">dp</span>, condense<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">relations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"cito:documents"</span>, <span class="va">relations</span><span class="op">$</span><span class="va">predicate</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           subject      predicate                  object</span></span>
<span><span class="co">## 18 sample-eml.xml cito:documents                  sciId1</span></span>
<span><span class="co">## 5  sample-eml.xml cito:documents       gre-predicted.png</span></span>
<span><span class="co">## 1  sample-eml.xml cito:documents logit-regr...-example.R</span></span>
<span><span class="co">## 3  sample-eml.xml cito:documents              binary.csv</span></span></code></pre>
<p>Relationships can be fully specified using the URI of the concept, as shown in the following statement that adds a provenance relationship between two objects in the example package:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/insertRelationship.html">insertRelationship</a></span><span class="op">(</span><span class="va">dp</span>, subjectID<span class="op">=</span><span class="va">sciId2</span>, objectIDs<span class="op">=</span><span class="va">sciId</span>,</span>
<span>                   predicate<span class="op">=</span><span class="st">"https://www.w3.org/ns/prov#wasDerivedFrom"</span><span class="op">)</span></span>
<span><span class="va">relations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getRelationships.html">getRelationships</a></span><span class="op">(</span><span class="va">dp</span>, condense<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">relations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"prov:wasDerivedFrom"</span>, <span class="va">relations</span><span class="op">$</span><span class="va">predicate</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>The relationships contained in a DataPackage conform to the <a href="https://www.w3.org/RDF/" class="external-link">Resource Description Framework</a> (RDF), which is a <a href="https://www.w3.org/" class="external-link">World Wide Web Consortium</a> standard for describing web accessible resources.</p>
</div>
</div>
<div class="section level2">
<h2 id="describing-the-contents-of-a-datapackage">Describing The Contents of a DataPackage<a class="anchor" aria-label="anchor" href="#describing-the-contents-of-a-datapackage"></a>
</h2>
<p>In order to transport a DataPackage, for example to a data repository, a description of the contents of the DataPackage is created so that the consumer of the DataPackage can determine how to extract and process the contents.</p>
<p>A DataPackage can produce a standard description of its members and relationships which conforms to the Open Archives Initiative <a href="https://www.openarchives.org/ore/" class="external-link">Object Reuse and Exchange</a> (OAI-ORE) specification, which is a widely used standard to describe aggregations of web accessible resources. This OAI-ORE description is referred to as a <em>resource map</em>.</p>
<p>The <code>serializePackage</code> method will create Resource Description Framework serialization of a resource map, written to a file in this case, that conforms to the OAI-ORE specification.</p>
<p>To create a resource map for the example DataPackage:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">packageId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"urn:uuid:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/serializePackage.html">serializePackage</a></span><span class="op">(</span><span class="va">dp</span>, file<span class="op">=</span><span class="va">tf</span>, id<span class="op">=</span><span class="va">packageId</span><span class="op">)</span></span></code></pre></div>
<p>This example writes to a tempfile using the default serialization format of “rdfxml”. Also the URLs for each package member are prepended with the default value of the DataONE resolve service, which would be the URL that could be used to access this data object if the package is uploaded to a DataONE member node.</p>
<p>A different value to be prepended to each identifier can be specified with the <code>resoveURI</code> argument. To specify that no value be prepended to the identifier URLs, specify a zero-length character:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">packageId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"urn:uuid:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/serializePackage.html">serializePackage</a></span><span class="op">(</span><span class="va">dp</span>, file<span class="op">=</span><span class="va">tf</span>, id<span class="op">=</span><span class="va">packageId</span>, resolveURI<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>It is also possible to create a JSON serialization, if desired:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">packageId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"urn:uuid:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/serializePackage.html">serializePackage</a></span><span class="op">(</span><span class="va">dp</span>, file<span class="op">=</span><span class="va">tf</span>, id<span class="op">=</span><span class="va">packageId</span>, syntaxName<span class="op">=</span><span class="st">"json"</span>, mimeType<span class="op">=</span><span class="st">"application/json"</span>, resolveURI<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="saving-datapackage-contents-to-a-file">Saving DataPackage Contents to a File<a class="anchor" aria-label="anchor" href="#saving-datapackage-contents-to-a-file"></a>
</h2>
<p>The contents of a DataPackage can be saved to a file using the <code>serializeToBagIt</code> method. This creates a <em>BagIt</em> file, which is a hierarchical file packaging format.</p>
<p>The created BagIt file contains the data from the DataPackage members as well as an OAI-ORE resource map that is automatically created by <code>serializeToBagIt</code>.</p>
<p>The following R command shows how to create the BagIt file for the example DataPackage:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bagitFilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/serializeToBagIt.html">serializeToBagIt</a></span><span class="op">(</span><span class="va">dp</span><span class="op">)</span></span></code></pre></div>
<p>The variable <code>bagitFilename</code> contains the file path to the temporary BagIt file. This file should be copied to another location before quitting or restarting R:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">bagitFilename</span>, <span class="st">"~/myPackageFile.zip"</span><span class="op">)</span></span></code></pre></div>
<p>This serialized BagIt version of the file is an excellent way to transport all of the files and metadata of a DataPackage to a data repository or a collaborator.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
